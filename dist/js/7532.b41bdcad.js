"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[7532],{1203:function(t,e,s){t.exports=s.p+"img/profile_default.2f6f1ea4.png"},3153:function(t,e,s){t.exports=s.p+"img/logo.5092d4aa.png"},6591:function(t,e,s){var a=s(9064);a.t1.register(...a.$L),e.Ay=a.t1},7532:function(t,e,s){s.r(e),s.d(e,{default:function(){return Z}});var a=s(6768),n=s(5130),i=s(4232),r=s(3153);const l={class:"d-flex flex-column justify-content-center align-items-center vh-100 position-relative bg-dark text-white overflow-hidden"},o={key:0,class:"card glass-card p-4 fade-in text-white overflow-hidden",style:{width:"400px","z-index":"5"}},d={class:"form-floating"},u={class:"form-floating"},c={key:0,class:"text-danger small mb-3 fade-in"},h=["disabled"],m={key:0},p={key:1},b={key:1,class:"card glass-card p-4 fade-in text-white overflow-hidden",style:{width:"80%","max-width":"1000px","z-index":"5"}},g={class:"row align-items-stretch overflow-hidden"},f={class:"col-md-7"},k={class:"d-flex justify-content-between align-items-center mb-3"},L={class:"text-uppercase text-white mb-0"},y={class:"col-md-5 d-flex flex-column"},v={class:"hstack mb-3"},w={class:"text-end"},_={class:"fw-semibold mb-0"},x={class:"mb-0 opacity-75"},D={class:"vstack mb-3 w-100"},C={class:"hstack gap-2"},I=["disabled"],E={key:0,class:"vstack justify-content-center align-items-center text-danger h-100 w-100"},S={key:1,class:"vstack h-100 justify-content-end"},T={class:"hstack justify-content-center w-100 h-100 position-relative"},V=["src"],X={key:0,class:"position-absolute bottom-0 end-0 me-2 badge bg-info rounded-circle p-1",title:"Verified"},F={class:"table mt-auto"},A={class:"text-capitalize"},U={key:0},M={key:1},j={key:2,class:"vstack justify-content-center align-items-center text-muted h-100"},z={class:"text-center mt-4 small opacity-75",style:{"z-index":"5"}};function $(t,e,s,$,P,Q){const B=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",l,[e[29]||(e[29]=(0,a.Lk)("div",{class:"position-absolute top-0 start-0 w-100 h-100 gradient-bg"},null,-1)),P.branch_id?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("div",g,[(0,a.Lk)("div",f,[(0,a.Lk)("div",k,[(0,a.Lk)("h5",L,[(0,a.bF)(B,{to:{name:"landing"},class:"mt-2 text-white me-3"},{default:(0,a.k6)(()=>e[11]||(e[11]=[(0,a.Lk)("i",{class:"bi bi-house fs-5"},null,-1)])),_:1,__:[11]}),e[12]||(e[12]=(0,a.eW)(" Student Entries per Hour "))]),e[13]||(e[13]=(0,a.Lk)("i",{class:"bi bi-bar-chart-line fs-4 text-prime"},null,-1))]),e[14]||(e[14]=(0,a.Lk)("canvas",{id:"entryChart",height:"300"},null,-1))]),(0,a.Lk)("div",y,[(0,a.Lk)("div",v,[e[15]||(e[15]=(0,a.Lk)("img",{src:r,alt:"Logo",width:"50"},null,-1)),e[16]||(e[16]=(0,a.Lk)("h5",{class:"mb-0 ms-2 me-auto"},"Attendance Log",-1)),(0,a.Lk)("div",w,[(0,a.Lk)("h4",_,(0,i.v_)(P.page.time),1),(0,a.Lk)("p",x,(0,i.v_)(P.page.date),1)])]),(0,a.Lk)("form",{onSubmit:e[6]||(e[6]=(0,n.D$)((...t)=>Q.handleSubmit&&Q.handleSubmit(...t),["prevent"]))},[(0,a.Lk)("div",D,[e[17]||(e[17]=(0,a.Lk)("label",{class:"form-label small opacity-75"},"Student ID",-1)),(0,a.Lk)("div",C,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"studentId","onUpdate:modelValue":e[3]||(e[3]=t=>P.form.id_number=t),ref:"studentIdInput",class:"form-control fs-5",placeholder:"Enter Student ID",required:"",autocomplete:"off",onFocus:e[4]||(e[4]=t=>P.isFocused=!0),onBlur:e[5]||(e[5]=t=>P.isFocused=!1)},null,544),[[n.Jo,P.form.id_number]]),(0,a.Lk)("button",{type:"submit",class:"btn btn-outline-prime px-3 fs-5",disabled:!P.form.id_number.trim()},"Submit",8,I)])])],32),(0,a.Lk)("div",{class:(0,i.C4)(["card h-100 w-100 p-3 overflow-hidden",{glow:P.studentData}])},[P.toastVisible&&P.toastMessage?((0,a.uX)(),(0,a.CE)("div",E,[e[18]||(e[18]=(0,a.Lk)("i",{class:"bi bi-person-fill-x display-1"},null,-1)),(0,a.eW)(" "+(0,i.v_)(P.toastMessage),1)])):(0,a.Q3)("",!0),P.toastVisible&&P.studentData?((0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("div",T,[e[20]||(e[20]=(0,a.Lk)("div",{class:"position-absolute top-0 start-0 w-100 rounded-top bg-prime",style:{height:"9rem"}},null,-1)),(0,a.Lk)("div",{class:(0,i.C4)(["d-flex align-items-center shadow-sm rounded-circle border position-relative",[1==P.studentData?.patron.user.pending_registration_approval?"border-info":"border-success"]]),style:{width:"150px",height:"150px","z-index":"2",background:"white"}},[(0,a.Lk)("img",{src:P.studentData?.patron.user.profile_picture,class:"rounded-circle",style:{width:"100%",height:"100%","object-fit":"contain"}},null,8,V),P.studentData?.patron.user.email_verified_at?((0,a.uX)(),(0,a.CE)("span",X,e[19]||(e[19]=[(0,a.Lk)("i",{class:"bi bi-check fw-bold fs-5"},null,-1)]))):(0,a.Q3)("",!0)],2)]),(0,a.Lk)("table",F,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[e[21]||(e[21]=(0,a.Lk)("th",null,"Name",-1)),(0,a.Lk)("td",A,(0,i.v_)(P.studentData?.patron.user.last_name+", "+P.studentData?.patron.user.first_name+(P.studentData?.patron.user.middle_initial?" "+P.studentData?.patron.user.middle_initial+".":"")),1)]),(0,a.Lk)("tr",null,[e[22]||(e[22]=(0,a.Lk)("th",null,"ID Number",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.patron.id_number),1)]),(0,a.Lk)("tr",null,[e[23]||(e[23]=(0,a.Lk)("th",null,"Patron Type",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.patron.patron_type.name),1)])]),3==P.studentData?.patron.patron_type.id?((0,a.uX)(),(0,a.CE)("tbody",U,[(0,a.Lk)("tr",null,[e[24]||(e[24]=(0,a.Lk)("th",null,"Organization/Campus",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.patron.external_organization),1)])])):((0,a.uX)(),(0,a.CE)("tbody",M,[(0,a.Lk)("tr",null,[e[25]||(e[25]=(0,a.Lk)("th",null,"Program",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.patron.program.abbrev),1)]),(0,a.Lk)("tr",null,[e[26]||(e[26]=(0,a.Lk)("th",null,"Department",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.patron.program.department.abbrev),1)])])),(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[e[27]||(e[27]=(0,a.Lk)("th",null,"Time In",-1)),(0,a.Lk)("td",null,(0,i.v_)(P.studentData?.created_at),1)])])])])):(0,a.Q3)("",!0),P.toastVisible||P.studentData?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",j,e[28]||(e[28]=[(0,a.Lk)("p",{class:"mb-0"},"No Data Available.",-1)])))],2)])])])):((0,a.uX)(),(0,a.CE)("div",o,[e[10]||(e[10]=(0,a.Lk)("div",{class:"mb-4 text-center text-light"},[(0,a.Lk)("img",{src:"/logo.png",alt:"ISU Logo",class:"mb-3",style:{width:"60px"}}),(0,a.Lk)("h2",{class:"fw-bold mb-0"},"Login"),(0,a.Lk)("small",{class:"text-secondary"},"Log in as librarian to access the page.")],-1)),(0,a.Lk)("form",{class:"vstack gap-4",onSubmit:e[2]||(e[2]=(0,n.D$)((...t)=>Q.login&&Q.login(...t),["prevent"]))},[(0,a.Lk)("div",d,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>P.username=t),class:"form-control border-0 text-center",id:"username",placeholder:"Enter Username",required:""},null,512),[[n.Jo,P.username]]),e[7]||(e[7]=(0,a.Lk)("label",{for:"username"},"Username",-1))]),(0,a.Lk)("div",u,[(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>P.password=t),class:"form-control border-0 text-center",id:"password",placeholder:"Enter Password",required:""},null,512),[[n.Jo,P.password]]),e[8]||(e[8]=(0,a.Lk)("label",{for:"password"},"Password",-1))]),P.error?((0,a.uX)(),(0,a.CE)("div",c,(0,i.v_)(P.error),1)):(0,a.Q3)("",!0),(0,a.Lk)("button",{class:"btn btn-lg btn-primary w-100 py-2 fw-bold position-relative overflow-hidden",disabled:P.loading,type:"submit"},[P.loading?((0,a.uX)(),(0,a.CE)("span",p,e[9]||(e[9]=[(0,a.Lk)("span",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),(0,a.eW)(" Logging in... ")]))):((0,a.uX)(),(0,a.CE)("span",m,"Login"))],8,h)],32)])),(0,a.Lk)("footer",z,"Â© "+(0,i.v_)((new Date).getFullYear())+" Isabela State University | e-Libra",1)])}s(8111),s(1701);var P=s(144),Q=s(6591),B=s(1203),N=s(8082),W=s(1661),q=s(14),J=s(445),G=s(4564),H={name:"AttendancePage",data(){return{username:"",password:"",error:"",loading:!1,isFocused:!1,form:{id_number:"",status:"Check-in"},page:{time:"",date:""},branch_id:null,profile_picture:B,studentData:null,toastMessage:"",toastVisible:!1,entryChart:null,hours:[],timer:null,entries:Array(10).fill(0)}},methods:{forceFocus(){this.$nextTick(()=>{const t=this.$refs.studentIdInput;t&&t.focus()})},updateDateTime(){const t=new Date;this.page.time=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.page.date=t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},async handleSubmit(){if(!this.form.id_number)return;clearTimeout(this.timer);const t=document.getElementById("studentId");t.select();const e=await(0,G.MB)("attendance/record",{branch_id:this.branch_id,id_number:this.form.id_number});this.toastVisible=!1,this.toastMessage="",e.data.status?(this.studentData=e.data.data,this.toastVisible=!0,this.fetchLogs(),setTimeout(()=>{this.studentData=null},5e3)):(this.toastMessage=e.data.message,this.toastVisible=!0),this.clearInput(),t.focus()},clearInput(){this.timer=setTimeout(()=>{this.form.id_number="",this.toastVisible=!1,this.toastMessage="",this.studentData=null},1e4)},initChart(){const t=document.getElementById("entryChart");t&&(this.entryChart&&this.entryChart.destroy(),this.entryChart=(0,P.IG)(new Q.Ay(t,{type:"line",data:{labels:this.hours,datasets:[{label:"Number of Entries",data:this.entries,backgroundColor:"rgba(34, 215, 152, 0.6)",borderColor:"#22d798",borderWidth:1}]},options:{scales:{x:{ticks:{color:"#fff"}},y:{beginAtZero:!0,ticks:{color:"#fff"},min:0,suggestedMax:10}},plugins:{legend:{labels:{color:"#fff"}}}}})))},async fetchLogs(){try{const t=await N.A.get("api/attendance/logs",{params:{branch_id:1}}),e=t.data;this.hours=e.map(t=>t.hour),this.entries=e.map(t=>t.total),this.entryChart&&(this.entryChart.data.labels=this.hours,this.entryChart.data.datasets[0].data=this.entries,this.entryChart.update())}catch(t){console.error("Failed to fetch logs:",t)}},async login(){(0,W.C)({message:"Logging in"});try{const t=await(0,q.iD)({user:this.username,password:this.password});q.Sh.value=t.data.access_token}catch(t){(0,J.w)({status:"error",title:"Error",message:t.message})}}},mounted(){this.updateDateTime(),setInterval(this.updateDateTime,1e3),this.branch_id=localStorage.getItem("branch_id")??null,this.forceFocus()},watch:{isFocused(t){t||this.forceFocus()},branch_id(t){t&&this.$nextTick(()=>{this.initChart(),this.fetchLogs(),setInterval(this.fetchLogs,6e4)})},"form.id_number"(){clearTimeout(this.timer),this.clearInput()}}},O=s(1241);const Y=(0,O.A)(H,[["render",$],["__scopeId","data-v-bf197d66"]]);var Z=Y}}]);
//# sourceMappingURL=7532.b41bdcad.js.map